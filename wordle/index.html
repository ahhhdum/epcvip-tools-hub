<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, interactive-widget=resizes-content">
  <title>Wordle Battle - EPCVIP</title>
  <link rel="stylesheet" href="/wordle/wordle.css">
</head>
<body>
  <div class="container">
    <!-- Header with Toolbar -->
    <header class="header">
      <div class="header-toolbar">
        <button id="backBtn" class="toolbar-btn back-btn hidden" aria-label="Go back">‚Üê</button>
        <div class="header-title">
          <h1 id="headerTitle">Wordle Battle</h1>
          <p class="tagline">Race to solve the word!</p>
        </div>
        <div class="toolbar-right">
          <button id="settingsBtn" class="toolbar-btn" aria-label="Settings">‚öôÔ∏è</button>
          <button id="profileBtn" class="toolbar-btn profile-btn" aria-label="Profile">
            <span class="profile-icon">üë§</span>
            <span class="profile-label" id="profileLabel">Guest</span>
          </button>
        </div>
      </div>
    </header>

    <!-- Profile Dropdown -->
    <div id="profileDropdown" class="profile-dropdown hidden">
      <div class="dropdown-content">
        <!-- When logged in -->
        <div id="profileLoggedIn" class="hidden">
          <div class="dropdown-header">
            <span class="profile-name" id="profileDisplayName">Guest</span>
            <span class="profile-email" id="profileEmail"></span>
          </div>
          <div class="dropdown-divider"></div>
          <button id="dropdownStats" class="dropdown-item">üìä View Stats</button>
          <button id="dropdownLogout" class="dropdown-item dropdown-item-danger">Logout</button>
        </div>
        <!-- When not logged in -->
        <div id="profileLoggedOut">
          <div class="dropdown-header">
            <span class="profile-name">Not signed in</span>
          </div>
          <div class="dropdown-divider"></div>
          <button id="dropdownLogin" class="dropdown-item">Login</button>
          <button id="dropdownSignup" class="dropdown-item">Sign Up</button>
          <button id="dropdownGuest" class="dropdown-item">Play as Guest</button>
        </div>
      </div>
    </div>

    <!-- Dropdown Overlay -->
    <div id="dropdownOverlay" class="dropdown-overlay hidden"></div>

    <!-- Lobby View -->
    <div id="lobby" class="view" data-testid="lobby">
      <div class="lobby-content lobby-simplified">
        <!-- Auth Banner (shown for guests) -->
        <div id="authBanner" class="auth-banner hidden">
          <div class="auth-banner-title">‚ú® Create an account to unlock:</div>
          <p class="auth-banner-benefits">
            Daily Challenges, stats tracking, streaks, and leaderboards
          </p>
          <div class="auth-banner-actions">
            <button id="bannerSignUp" class="auth-btn auth-btn-primary">Sign Up</button>
            <button id="bannerLogIn" class="auth-btn auth-btn-secondary">Log In</button>
          </div>
        </div>

        <!-- Primary CTA: Daily Challenge -->
        <div id="dailyBtnContainer" class="daily-btn-container">
          <button id="dailyChallengeBtn" class="btn-lobby btn-lobby-primary" disabled>
            <span class="btn-lobby-icon" id="dailyIcon">üîí</span>
            <div class="btn-lobby-content">
              <span class="btn-lobby-title">Daily Challenge #<span id="dailyNum">---</span></span>
              <span class="btn-lobby-subtitle" id="dailySubtitle">Sign in to play</span>
            </div>
          </button>
          <!-- Tooltip shown when logged out and tapping disabled daily -->
          <div id="dailyTooltip" class="feature-tooltip hidden">
            <p>Sign in to play daily challenges and track your stats!</p>
            <button class="tooltip-cta" id="tooltipSignIn">Sign in</button>
          </div>
        </div>

        <!-- Secondary CTA: Play With Friends -->
        <button id="playWithFriendsLobbyBtn" class="btn-lobby btn-lobby-secondary">
          <span class="btn-lobby-icon">üë•</span>
          <div class="btn-lobby-content">
            <span class="btn-lobby-title">Play With Friends</span>
            <span class="btn-lobby-subtitle">Create or join a room</span>
          </div>
        </button>

        <!-- Solo Practice -->
        <button id="soloPracticeBtn" class="btn-lobby btn-lobby-tertiary" data-testid="solo-practice">
          <span class="btn-lobby-icon">üé≤</span>
          <div class="btn-lobby-content">
            <span class="btn-lobby-title">Solo Practice</span>
            <span class="btn-lobby-subtitle">Random words, no pressure</span>
          </div>
        </button>

        <!-- Tertiary CTA: Past Dailies -->
        <button id="historicalDailiesBtn" class="btn-lobby btn-lobby-tertiary">
          <span class="btn-lobby-icon">üìÖ</span>
          <div class="btn-lobby-content">
            <span class="btn-lobby-title">Past Dailies</span>
            <span class="btn-lobby-subtitle">Solo or with friends</span>
          </div>
        </button>

        <!-- Compact Stats Strip -->
        <button id="statsStrip" class="stats-strip hidden">
          <span id="statsWins">0 wins</span>
          <span class="stats-separator">¬∑</span>
          <span id="statsStreak">üî• 0</span>
          <span class="stats-separator">¬∑</span>
          <span id="statsBest">Best: 0</span>
        </button>

        <!-- Guest prompt (shown when not logged in) -->
        <p id="guestPrompt" class="guest-prompt">
          <a href="#" id="loginPromptLink">Sign in</a> to save your progress
        </p>
      </div>
    </div>

    <!-- Play With Friends Bottom Sheet -->
    <div id="friendsSheet" class="bottom-sheet hidden">
      <div class="sheet-backdrop"></div>
      <div class="sheet-container">
        <div class="sheet-header">
          <h3>Play With Friends</h3>
          <button id="closeFriendsSheet" class="sheet-close" aria-label="Close">√ó</button>
        </div>
        <div class="sheet-content">
          <!-- Create Room -->
          <button id="createRoom" class="btn btn-primary sheet-btn" data-testid="create-room">Create Room</button>

          <!-- Join with Code -->
          <div class="sheet-join-section">
            <input type="text" id="roomCodeInput" placeholder="Room Code" maxlength="6" autocomplete="off" data-testid="room-code-input">
            <button id="joinRoom" class="btn btn-secondary" data-testid="join-room">Join</button>
          </div>

          <!-- Public Rooms (only if rooms exist) -->
          <div id="publicRoomsSection" class="public-rooms-section hidden">
            <h4>Public Rooms</h4>
            <div id="publicRoomsList" class="public-rooms-list"></div>
          </div>
        </div>
      </div>
    </div>

    <!-- Solo Settings View -->
    <div id="soloSettings" class="view hidden" data-testid="solo-settings">
      <div class="solo-settings-content">
        <div class="view-header">
          <h2>Solo Practice</h2>
          <p class="view-subtitle">Configure your game</p>
        </div>

        <!-- Quick Play CTA -->
        <button id="soloQuickPlayBtn" class="btn-solo-quick" data-testid="solo-quick-play">
          <span class="quick-icon">‚ö°</span>
          <span class="quick-text">Quick Play</span>
        </button>

        <!-- Word Selection -->
        <div class="config-card">
          <label>Word Selection</label>
          <div class="mode-buttons mode-buttons-solo">
            <button id="soloWordDaily" class="mode-btn" disabled data-mode="daily">Daily</button>
            <button id="soloWordRandom" class="mode-btn active" data-mode="random">Random</button>
          </div>
          <p id="soloWordHint" class="config-hint-link">
            <a href="#" id="soloSignInLink">Sign in</a> to play daily challenges
          </p>
        </div>

        <!-- Game Mode -->
        <div class="config-card">
          <label>Game Mode</label>
          <div class="mode-buttons mode-buttons-solo">
            <button id="soloModeStandard" class="mode-btn-rich active">
              <span class="mode-title">Standard</span>
              <span class="mode-desc">Random word from our list</span>
            </button>
          </div>
          <!-- Sabotage Teaser -->
          <div id="sabotageTeaser" class="sabotage-teaser">
            <span class="teaser-icon">üé≠</span>
            <div class="teaser-content">
              <div class="teaser-title">Sabotage Mode</div>
              <div class="teaser-subtitle">Pick your opponent's word</div>
            </div>
            <span class="teaser-badge">Multiplayer</span>
          </div>
          <!-- Sabotage Expanded (hidden by default) -->
          <div id="sabotageExpanded" class="sabotage-expanded hidden">
            <div class="expanded-title">üé≠ What is Sabotage Mode?</div>
            <p class="expanded-desc">
              In Sabotage, you pick the word your opponent has to guess - and they pick yours!
              Choose tricky words to stump your friends.
            </p>
            <button id="sabotageToMultiplayer" class="btn-try-multiplayer">
              üë• Play With Friends
            </button>
          </div>
        </div>

        <!-- Hard Mode -->
        <div class="config-card">
          <label>Hard Mode</label>
          <div class="config-toggle-row">
            <span class="config-toggle-label">Require revealed hints</span>
            <button id="soloHardMode" class="toggle-btn" aria-pressed="false">Off</button>
          </div>
          <p class="config-hint">Green letters must stay in position, yellow letters must be reused</p>
        </div>

        <!-- Actions -->
        <div class="config-actions">
          <button id="soloCancel" class="btn btn-secondary">Cancel</button>
          <button id="soloStart" class="btn btn-primary" data-testid="solo-start">Start Game</button>
        </div>
      </div>
    </div>

    <!-- Hidden: Player name stored in settings, used when creating/joining -->
    <input type="hidden" id="playerName" value="">

    <!-- Room Configuration View (Pre-Creation) -->
    <div id="roomConfig" class="view hidden">
      <div class="config-content">
        <div class="view-header">
          <h2>Create Room</h2>
          <p class="view-subtitle">Configure your game settings</p>
        </div>

        <!-- Game Mode Card -->
        <div class="config-card">
          <label>Game Mode</label>
          <div class="mode-buttons">
            <button id="configModeCasual" class="mode-btn active" data-mode="casual">Casual</button>
            <button id="configModeCompetitive" class="mode-btn" data-mode="competitive">Competitive</button>
          </div>
        </div>

        <!-- Word Selection Card -->
        <div class="config-card">
          <label>Word Selection</label>
          <div class="mode-buttons mode-buttons-triple">
            <button id="configWordDaily" class="mode-btn active" data-mode="daily">Daily</button>
            <button id="configWordRandom" class="mode-btn" data-mode="random">Random</button>
            <button id="configWordSabotage" class="mode-btn" data-mode="sabotage">Sabotage</button>
          </div>
          <p id="sabotageHintConfig" class="config-hint hidden">Pick words for your opponents!</p>
        </div>

        <!-- Hard Mode Card -->
        <div class="config-card">
          <label>Hard Mode</label>
          <div class="config-toggle-row">
            <span class="config-toggle-label">Require revealed hints</span>
            <button id="configHardMode" class="toggle-btn" aria-pressed="false">Off</button>
          </div>
          <p class="config-hint">Green letters must stay in position, yellow letters must be reused</p>
        </div>

        <!-- Room Visibility Card -->
        <div class="config-card">
          <label>Room Visibility</label>
          <div class="mode-buttons">
            <button id="configVisPublic" class="mode-btn active" data-visibility="public">Public</button>
            <button id="configVisPrivate" class="mode-btn" data-visibility="private">Private</button>
          </div>
          <p class="config-hint">Public rooms appear in lobby for others to join</p>
        </div>

        <!-- Action Buttons -->
        <div class="config-actions">
          <button id="configCancel" class="btn btn-secondary">Cancel</button>
          <button id="configCreate" class="btn btn-primary">Create Room</button>
        </div>
      </div>
    </div>

    <!-- Waiting Room View -->
    <div id="waiting" class="view hidden">
      <div class="waiting-content">
        <!-- Room Code Header -->
        <div class="room-code-display">
          <span class="label">Room Code</span>
          <span id="roomCode" class="code" data-testid="room-code">------</span>
          <button id="copyCode" class="btn-icon" title="Copy code">üìã</button>
          <button id="copyLink" class="btn-icon" title="Copy shareable link">üîó</button>
        </div>

        <!-- Settings Card -->
        <div class="waiting-card" id="settingsCard">
          <div class="waiting-card-label">Settings</div>

          <div class="mode-selector">
            <label>Game Mode</label>
            <div class="mode-buttons">
              <button id="modeCasual" class="mode-btn active" data-mode="casual">Casual</button>
              <button id="modeCompetitive" class="mode-btn" data-mode="competitive">Competitive</button>
            </div>
          </div>

          <div class="word-mode-selector">
            <label>Word Selection <span id="dailyNumber" class="daily-number hidden"></span></label>
            <div class="mode-buttons mode-buttons-triple">
              <button id="wordModeDaily" class="mode-btn active" data-mode="daily">Daily</button>
              <button id="wordModeRandom" class="mode-btn" data-mode="random">Random</button>
              <button id="wordModeSabotage" class="mode-btn" data-mode="sabotage">Sabotage</button>
            </div>
            <p id="sabotageHintWaiting" class="mode-hint hidden">Pick words for your opponents!</p>
          </div>

          <div id="visibilitySelector" class="visibility-selector hidden">
            <label>Room Visibility</label>
            <div class="visibility-buttons">
              <button id="visibilityPublic" class="vis-btn active" data-visibility="public">Public</button>
              <button id="visibilityPrivate" class="vis-btn" data-visibility="private">Private</button>
            </div>
            <p class="visibility-hint" id="visibilityHint">Public rooms appear in lobby for others to join</p>
          </div>
        </div>

        <!-- Players Card -->
        <div class="waiting-card">
          <div class="waiting-card-label">Players <span id="playerCount">(0)</span></div>
          <ul id="players" class="player-list"></ul>
        </div>

        <!-- Actions Card -->
        <div class="actions-card">
          <button id="readyBtn" class="btn btn-ready" data-testid="ready-button">I'm Ready</button>
          <div class="secondary-actions">
            <button id="startGame" class="btn btn-primary hidden disabled" data-testid="start-game">Start Game</button>
            <button id="leaveRoom" class="btn btn-leave-outline">Leave Room</button>
            <button id="closeRoom" class="btn btn-danger hidden">Close Room</button>
          </div>
          <p id="waitingMessage" class="waiting-msg">Waiting for host to start...</p>
        </div>
      </div>
    </div>

    <!-- Countdown Overlay -->
    <div id="countdownOverlay" class="countdown-overlay hidden">
      <div class="countdown-content">
        <span id="countdownNumber" class="countdown-number">3</span>
      </div>
    </div>

    <!-- Word Selection Phase (Sabotage Mode) -->
    <div id="wordSelection" class="view hidden" data-testid="selection-phase">
      <div class="selection-content">
        <div class="selection-header">
          <h2>Pick a Word</h2>
          <p class="selection-subtitle">Choose a tricky word for your opponent!</p>
        </div>

        <!-- Timer -->
        <div class="selection-timer">
          <span id="selectionTimeRemaining">30</span>s
        </div>

        <!-- Word Input Grid (like guess tiles) -->
        <div class="selection-grid">
          <div class="selection-row">
            <div class="selection-tile" id="selTile0"></div>
            <div class="selection-tile" id="selTile1"></div>
            <div class="selection-tile" id="selTile2"></div>
            <div class="selection-tile" id="selTile3"></div>
            <div class="selection-tile" id="selTile4"></div>
          </div>
        </div>

        <!-- Validation Status -->
        <p id="selectionStatus" class="selection-status"></p>

        <!-- Submit Button -->
        <button id="submitWordBtn" class="btn btn-primary selection-submit" disabled>Submit Word</button>

        <!-- Progress -->
        <div class="selection-progress">
          <span id="selectionProgress">Waiting for others...</span>
        </div>

        <!-- On-screen keyboard for selection -->
        <div id="selectionKeyboard" class="keyboard selection-keyboard">
          <div class="keyboard-row">
            <button data-key="Q">Q</button>
            <button data-key="W">W</button>
            <button data-key="E">E</button>
            <button data-key="R">R</button>
            <button data-key="T">T</button>
            <button data-key="Y">Y</button>
            <button data-key="U">U</button>
            <button data-key="I">I</button>
            <button data-key="O">O</button>
            <button data-key="P">P</button>
          </div>
          <div class="keyboard-row">
            <button data-key="A">A</button>
            <button data-key="S">S</button>
            <button data-key="D">D</button>
            <button data-key="F">F</button>
            <button data-key="G">G</button>
            <button data-key="H">H</button>
            <button data-key="J">J</button>
            <button data-key="K">K</button>
            <button data-key="L">L</button>
          </div>
          <div class="keyboard-row">
            <button data-key="ENTER" class="key-wide key-enter" disabled>ENTER</button>
            <button data-key="Z">Z</button>
            <button data-key="X">X</button>
            <button data-key="C">C</button>
            <button data-key="V">V</button>
            <button data-key="B">B</button>
            <button data-key="N">N</button>
            <button data-key="M">M</button>
            <button data-key="BACKSPACE" class="key-wide">‚å´</button>
          </div>
        </div>
      </div>
    </div>

    <!-- Reconnecting Overlay -->
    <div id="reconnectingOverlay" class="reconnecting-overlay hidden">
      <div class="reconnecting-content">
        <div class="reconnecting-spinner"></div>
        <p class="reconnecting-text">Reconnecting...</p>
        <p class="reconnecting-subtext">Please wait</p>
      </div>
    </div>

    <!-- Game View -->
    <div id="game" class="view hidden">
      <div class="game-layout">
        <!-- Opponent boards (left side) -->
        <div class="opponents-panel">
          <h3>Opponents</h3>
          <div id="opponentBoards"></div>
        </div>

        <!-- Main game area (center) -->
        <div class="main-game">
          <div class="game-header">
            <button id="leaveGameBtn" class="btn-leave" title="Leave Game">
              <span class="leave-icon">‚Üê</span>
              <span class="leave-text">Leave</span>
            </button>
            <div class="timer-display">
              <span id="gameTimer">0:00</span>
            </div>
          </div>

          <div id="grid" class="grid"></div>

          <div id="message" class="game-message"></div>

          <div id="keyboard" class="keyboard">
            <div class="keyboard-row">
              <button data-key="Q">Q</button>
              <button data-key="W">W</button>
              <button data-key="E">E</button>
              <button data-key="R">R</button>
              <button data-key="T">T</button>
              <button data-key="Y">Y</button>
              <button data-key="U">U</button>
              <button data-key="I">I</button>
              <button data-key="O">O</button>
              <button data-key="P">P</button>
            </div>
            <div class="keyboard-row">
              <button data-key="A">A</button>
              <button data-key="S">S</button>
              <button data-key="D">D</button>
              <button data-key="F">F</button>
              <button data-key="G">G</button>
              <button data-key="H">H</button>
              <button data-key="J">J</button>
              <button data-key="K">K</button>
              <button data-key="L">L</button>
            </div>
            <div class="keyboard-row">
              <button data-key="ENTER" class="key-wide key-enter">ENTER</button>
              <button data-key="Z">Z</button>
              <button data-key="X">X</button>
              <button data-key="C">C</button>
              <button data-key="V">V</button>
              <button data-key="B">B</button>
              <button data-key="N">N</button>
              <button data-key="M">M</button>
              <button data-key="BACKSPACE" class="key-wide">‚å´</button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Results View -->
    <div id="results" class="view hidden">
      <div class="results-content">
        <h2>Game Over!</h2>

        <div class="word-reveal">
          <span class="label">The word was</span>
          <span id="revealedWord" class="revealed-word">-----</span>
        </div>

        <div class="leaderboard">
          <h3>Results</h3>
          <ol id="resultsList"></ol>
        </div>

        <div class="results-actions">
          <button id="playAgain" class="btn btn-primary">Play Again</button>
          <button id="backToLobby" class="btn btn-secondary">Back to Lobby</button>
        </div>
      </div>
    </div>

    <!-- Daily Challenge Completed View -->
    <div id="dailyCompleted" class="view hidden">
      <div class="daily-completed-content">
        <h2>Daily Challenge #<span id="completedDailyNum">---</span></h2>
        <p class="completed-status">Completed Today</p>

        <!-- Word reveal section -->
        <div class="word-reveal-section">
          <span class="word-reveal-label">The word was</span>
          <span id="completedWord" class="revealed-word">-----</span>
        </div>

        <div id="completedGridContainer" class="completed-grid-container">
          <!-- Grid will be built dynamically -->
        </div>

        <div class="completion-stats">
          <div class="stat-item">
            <span class="stat-value" id="completedGuesses">-</span>
            <span class="stat-label">guesses</span>
          </div>
          <div class="stat-item">
            <span class="stat-value" id="completedTime">-</span>
            <span class="stat-label">time</span>
          </div>
          <div class="stat-item">
            <span class="stat-value" id="completedResult">-</span>
            <span class="stat-label">result</span>
          </div>
        </div>

        <p id="nextDailyCountdown" class="next-daily-msg"></p>

        <div class="completion-actions">
          <button id="playRandomInstead" class="btn btn-primary">Play Random Game</button>
          <button id="backFromDaily" class="btn btn-secondary">Back to Lobby</button>
        </div>
      </div>
    </div>

    <!-- Stats Dashboard View -->
    <div id="statsView" class="view hidden">
      <div class="stats-view-content">
        <h2>üìä Your Stats</h2>
        <p class="stats-subtitle">Track your Wordle Battle performance</p>

        <!-- Stats Grid (2 rows x 3 cols) -->
        <div class="stats-grid">
          <div class="stat-card">
            <span class="stat-card-value" id="statsGamesPlayed">0</span>
            <span class="stat-card-label">Played</span>
          </div>
          <div class="stat-card">
            <span class="stat-card-value" id="statsWinRate">0%</span>
            <span class="stat-card-label">Win %</span>
          </div>
          <div class="stat-card">
            <span class="stat-card-value" id="statsCurrentStreak">0</span>
            <span class="stat-card-label">üî• Streak</span>
          </div>
          <div class="stat-card">
            <span class="stat-card-value" id="statsBestStreak">0</span>
            <span class="stat-card-label">Best Streak</span>
          </div>
          <div class="stat-card">
            <span class="stat-card-value" id="statsFastestTime">--:--</span>
            <span class="stat-card-label">‚ö° Fastest</span>
          </div>
          <div class="stat-card">
            <span class="stat-card-value" id="statsAvgTime">--:--</span>
            <span class="stat-card-label">Average</span>
          </div>
        </div>

        <!-- Guess Distribution -->
        <div class="distribution-section">
          <h3>Guess Distribution</h3>
          <div id="distributionChart" class="distribution-chart">
            <!-- Bars will be rendered by JavaScript -->
          </div>
        </div>

        <button id="backFromStats" class="btn btn-link">‚Üê Back to Lobby</button>
      </div>
    </div>

    <!-- Settings View -->
    <div id="settingsView" class="view hidden">
      <div class="settings-content">
        <h2>‚öôÔ∏è Settings</h2>

        <!-- Display Name -->
        <div class="settings-card">
          <label for="settingsName">Display Name</label>
          <input type="text" id="settingsName" placeholder="Enter your name" maxlength="20" autocomplete="off">
          <p class="settings-hint">This name is shown to other players</p>
        </div>

        <!-- Sound Settings (placeholder for future) -->
        <div class="settings-card">
          <label>Sound</label>
          <div class="settings-toggle">
            <span>Sound Effects</span>
            <button id="soundToggle" class="toggle-btn" aria-pressed="true">On</button>
          </div>
        </div>

        <!-- Account Section (shown when logged in) -->
        <div id="settingsAccountSection" class="settings-card hidden">
          <label>Account</label>
          <div id="changePasswordSection">
            <button id="changePasswordBtn" class="btn btn-secondary settings-action-btn">Change Password</button>
          </div>
          <!-- Change Password Form (hidden by default) -->
          <div id="changePasswordForm" class="settings-form hidden">
            <input type="password" id="currentPassword" placeholder="Current password" autocomplete="current-password">
            <input type="password" id="newPasswordSettings" placeholder="New password" autocomplete="new-password">
            <input type="password" id="confirmNewPassword" placeholder="Confirm new password" autocomplete="new-password">
            <p id="changePasswordError" class="error-message hidden"></p>
            <p id="changePasswordSuccess" class="success-message hidden"></p>
            <div class="settings-form-actions">
              <button id="submitPasswordChange" class="btn btn-primary">Update Password</button>
              <button id="cancelPasswordChange" class="btn btn-secondary">Cancel</button>
            </div>
          </div>
        </div>

        <button id="backFromSettings" class="btn btn-link">‚Üê Back to Lobby</button>
      </div>
    </div>

    <!-- Historical Dailies View -->
    <div id="historicalDailies" class="view hidden">
      <div class="historical-content">
        <h2>Historical Dailies</h2>
        <p class="historical-subtitle">Play past daily challenges you may have missed</p>

        <!-- Quick Play Section -->
        <div class="quick-play-section">
          <button id="randomUnplayedBtn" class="btn btn-primary btn-large">
            üé≤ Random Unplayed Daily
          </button>
          <p id="randomUnplayedInfo" class="quick-play-info"></p>
        </div>

        <!-- Recent Section -->
        <div class="recent-section">
          <h3>Recent</h3>
          <div id="recentDailiesList" class="recent-dailies-list">
            <!-- Will be populated dynamically -->
          </div>
        </div>

        <!-- Browse Section -->
        <div class="browse-section">
          <h3>Browse All</h3>
          <div class="browse-controls">
            <input type="number" id="browseDailyNumber" placeholder="Daily #" min="1" class="browse-input">
            <button id="browseGoBtn" class="btn btn-secondary">Go</button>
          </div>
          <p class="browse-range" id="browseRange">Enter a daily number between 1 and ---</p>
        </div>

        <button id="backFromHistorical" class="btn btn-link">‚Üê Back to Lobby</button>
      </div>
    </div>

    <!-- Historical Daily Mode Modal (same as daily but for historical) -->
    <div id="historicalModeModal" class="modal hidden">
      <div class="modal-overlay"></div>
      <div class="modal-content daily-mode-modal">
        <h2>Daily #<span id="historicalModalNum">---</span></h2>
        <p class="historical-modal-date" id="historicalModalDate"></p>

        <div class="mode-options">
          <button id="historicalSoloBtn" class="mode-option-btn primary">
            <span class="mode-icon">üéØ</span>
            <span class="mode-title">Play Solo</span>
            <span class="mode-desc">Start immediately</span>
          </button>

          <button id="historicalMultiBtn" class="mode-option-btn secondary">
            <span class="mode-icon">üë•</span>
            <span class="mode-title">Play with Friends</span>
            <span class="mode-desc">Create room & share code</span>
          </button>
        </div>

        <button id="cancelHistoricalMode" class="btn btn-link">Cancel</button>
      </div>
    </div>

    <!-- Connection status -->
    <div id="connectionStatus" class="connection-status">
      <span class="status-dot"></span>
      <span class="status-text">Connecting...</span>
    </div>

    <!-- Error toast -->
    <div id="errorToast" class="toast hidden"></div>

    <!-- Login/Signup Modal -->
    <div id="authModal" class="modal hidden">
      <div class="modal-overlay"></div>
      <div class="modal-content">
        <h2 id="modalTitle">Login</h2>
        <form id="authForm">
          <div class="form-group">
            <input type="email" id="authEmail" placeholder="Email" required autocomplete="email">
          </div>
          <div class="form-group">
            <input type="password" id="authPassword" placeholder="Password" required autocomplete="current-password">
          </div>
          <div class="form-group hidden" id="displayNameGroup">
            <input type="text" id="authDisplayName" placeholder="Display Name" autocomplete="name">
          </div>
          <p id="authError" class="error-message hidden"></p>
          <div class="modal-buttons">
            <button type="submit" id="authSubmit" class="btn btn-primary">Login</button>
            <button type="button" id="closeModal" class="btn btn-secondary">Cancel</button>
          </div>
        </form>
        <p id="authToggle" class="auth-toggle">
          Don't have an account? <a href="#" id="switchToSignup">Sign up</a>
        </p>
        <p class="forgot-password-link">
          <a href="#" id="forgotPasswordLink">Forgot Password?</a>
        </p>

        <!-- Reset Password Form (request reset link) -->
        <form id="resetPasswordForm" class="hidden">
          <p class="reset-instructions">Enter your email and we'll send you a link to reset your password.</p>
          <div class="form-group">
            <input type="email" id="resetEmail" placeholder="Email" required autocomplete="email">
          </div>
          <p id="resetError" class="error-message hidden"></p>
          <p id="resetSuccess" class="success-message hidden"></p>
          <div class="modal-buttons">
            <button type="submit" id="sendResetLink" class="btn btn-primary">Send Reset Link</button>
            <button type="button" id="backToLogin" class="btn btn-secondary">Back to Login</button>
          </div>
        </form>

        <!-- Update Password Form (set new password after clicking reset link) -->
        <form id="updatePasswordForm" class="hidden">
          <p class="reset-instructions">Enter your new password.</p>
          <div class="form-group">
            <input type="password" id="newPassword" placeholder="New Password" required minlength="6" autocomplete="new-password">
          </div>
          <div class="form-group">
            <input type="password" id="confirmPassword" placeholder="Confirm Password" required minlength="6" autocomplete="new-password">
          </div>
          <p id="updateError" class="error-message hidden"></p>
          <div class="modal-buttons">
            <button type="submit" id="updatePasswordBtn" class="btn btn-primary">Update Password</button>
          </div>
        </form>
      </div>
    </div>

    <!-- Daily Mode Selection Modal -->
    <div id="dailyModeModal" class="modal hidden">
      <div class="modal-overlay"></div>
      <div class="modal-content daily-mode-modal">
        <h2>Daily Challenge #<span id="modalDailyNum">---</span></h2>
        <p class="daily-mode-note">One attempt per account</p>

        <div class="mode-options">
          <button id="playSoloBtn" class="mode-option-btn primary">
            <span class="mode-icon">üéØ</span>
            <span class="mode-title">Play Solo</span>
            <span class="mode-desc">Start immediately</span>
          </button>

          <button id="playWithFriendsBtn" class="mode-option-btn secondary">
            <span class="mode-icon">üë•</span>
            <span class="mode-title">Play with Friends</span>
            <span class="mode-desc">Create room & share code</span>
          </button>
        </div>

        <button id="cancelDailyMode" class="btn btn-link">Cancel</button>
      </div>
    </div>

    <!-- Daily Confirmation Modal (shown before starting daily) -->
    <div id="dailyConfirmModal" class="modal hidden">
      <div class="modal-overlay"></div>
      <div class="modal-content confirm-modal">
        <h2>Ready for Daily #<span id="confirmDailyNum">---</span>?</h2>
        <p class="confirm-warning">This is your ONE shot for today!</p>
        <p class="confirm-note">Once you start, this counts as your daily attempt. No pressure... but also, pressure.</p>
        <div class="confirm-actions">
          <button id="confirmDailyStart" class="btn btn-primary">Let's Go!</button>
          <button id="confirmDailyCancel" class="btn btn-secondary">Maybe Later</button>
        </div>
      </div>
    </div>

    <!-- Leave Game Confirmation Modal (for daily with progress) -->
    <div id="leaveConfirmModal" class="modal hidden">
      <div class="modal-overlay"></div>
      <div class="modal-content confirm-modal">
        <h2>Leave Game?</h2>
        <p class="confirm-note" id="leaveConfirmMessage">Your progress will be saved. You can resume this daily later.</p>
        <div class="confirm-actions">
          <button id="confirmLeave" class="btn btn-danger">Leave</button>
          <button id="cancelLeave" class="btn btn-secondary">Stay</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Supabase CDN -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

  <!-- Supabase configuration (shared with Tools Hub - epcvip-auth project) -->
  <script>
    // Same Supabase project as Tools Hub for unified auth
    window.SUPABASE_CONFIG = {
      url: 'https://yuithqxycicgokkgmpzg.supabase.co',
      anonKey: '' // Set via SUPABASE_ANON_KEY environment variable
    };
    // Allow override from environment (for Railway deployment)
    if (typeof SUPABASE_ANON_KEY !== 'undefined') {
      window.SUPABASE_CONFIG.anonKey = SUPABASE_ANON_KEY;
    }

    // Multiplayer server (same origin)
    const protocol = window.location.protocol === 'https:' ? 'wss:' : 'ws:';
    window.MULTIPLAYER_SERVER = `${protocol}//${window.location.host}`;
  </script>

  <script type="module" src="/wordle/wordle.js"></script>
</body>
</html>
